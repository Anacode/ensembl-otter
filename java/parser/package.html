<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
</head>
<body bgcolor="white">

<p>This is a SAX-based parser that reads Otter-format xml and creates
Apollo objects (AssemblyFeatures, Genes, Transcripts, Exons)</p>

<p>The main content handler (extending DefaultContentHandler) is
OtterContentHandler. It is passed an InputStream - which is usually
created from a file, but you could also create it from a URL....</p>

<p>The OtterContentHandler delegates actions from its startElement etc
methods to the actual tag classes. There's one class TagHandler for
each tag in the otter schema. All these classes end with the string "TagHandler" -
xxxExonTagHandler etc <p>

<p>Using the parser to generate apollo objects: Here's the code in
the OtterAdapter that drives the parser. Note that I use an InputStream
to hand in the parse source.</p>

<code>
    XMLReader parser;
    OtterContentHandler handler;
    InputSource theFileReader;
    GenericAnnotationSet theSet;
    StrandedFeatureSet returnSet;
    Iterator featureIterator;
    SeqFeatureI theResultFeature;
    int low = -1; //lower bound for annotation set
    int high = -1; //upper bound for annotation set
    
    try{
      parser = XMLReaderFactory.createXMLReader();
      handler = new OtterContentHandler();
      theFileReader = new InputSource(getInputStream());
      parser.setContentHandler(handler);
      parser.parse(theFileReader);
    }catch(IOException theException){
      throw new IllegalStateException("Error parsing input xml-stream");
    }catch(SAXException theException){
      throw new IllegalStateException("Error parsing input xml-stream");
    }//end try
    
    theSet = (GenericAnnotationSet)handler.getReturnedObjects().iterator().next();  

    returnSet = 
      new StrandedFeatureSet(
        new GenericAnnotationSet(), 
        new GenericAnnotationSet()
      );

    //...proceed to copy in the returned GenericAnnotationSet into 
    //...the curation set. 
</code>


</body>
</html>

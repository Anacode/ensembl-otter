#!/bin/tcsh

setenv OTTER_HOME /Users/michele/cvs/ensembl-otter/dist
setenv APOLLO_ROOT ${OTTER_HOME}/cvs/apollo
setenv OTTER_MYSQL_PORT 3377

# Set up the perl environment

echo "Setting up perl environment"

setenv PERL5LIB ${OTTER_HOME}/cvs/ensembl/modules
setenv PERL5LIB ${PERL5LIB}:${OTTER_HOME}/cvs/ensembl-otter/modules
setenv PERL5LIB ${PERL5LIB}:${OTTER_HOME}/cvs/bioperl-live
setenv PERL5LIB ${PERL5LIB}:${OTTER_HOME}/cvs/ensembl-otter/conf
setenv PERL5LIB ${PERL5LIB}:${OTTER_HOME}/cvs/ensembl-otter/scripts/server

# Set up the path

echo "Setting up path"

setenv TMPPATH $PATH

setenv PATH ${OTTER_HOME}/bin
setenv PATH ${PATH}:${OTTER_HOME}/ensembl-otter/scripts
setenv PATH ${PATH}:${OTTER_HOME}/ensembl-otter/scripts/server
setenv PATH ${PATH}:${TMPPATH}

# Start mysql

echo "Starting mysql daemon on port " $OTTER_MYSQL_PORT

cd $OTTER_HOME/mysql

./bin/safe_mysqld --user=otter \
                  --set-variable=max_connections=1500 \
                  --set-variable=wait_timeout=267820 \
                  --set-variable=net_buffer_length=16M \
                  --set-variable=max_allowed_packet=16M \
                  --set-variable=key_buffer=128M \
                  --set-variable=table_cache=512 \
                  --set-variable=sort_buffer=8M \
                  --set-variable=record_buffer=2M \
                  --set-variable=thread_cache=4 \
                  --set-variable=thread_concurrency=4 \
                  --set-variable=tmp_table_size=10048576 \
                  --port=${OTTER_MYSQL_PORT} \
                  --socket=/tmp/otter.sock &

# Start otter

echo "Starting otter" 

$OTTER_HOME/cvs/ensembl-otter/scripts/otter_srv >& $OTTER_HOME/logs/otter_srv.$$.log &

# Start web server

#$OTTER_HOME/bin/httpd -d $OTTER_HOME/web/conf &

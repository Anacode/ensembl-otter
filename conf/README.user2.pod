=pod

=head1 How to setup sequence_set level access

=head1 SYNOPSIS

This document describes how to setup the sequence set access list
authentication on the otter server.

=head1 DESCRIPTION

The authentication for datasets takes place using the .htaccess style
mechanism, see conf/README.user.pod.  The sequence sets an authenticated
user is allowed to see is controlled by entries in the following tables
in the database of that dataset.

sequence_set        - the list of sequence sets
sequence_set_access - the rules on which sets a user can see
access_author       - the list of rules a user owns
author              - the users

=head1 LOGIC

A user may have zero, one or many rules which allow (join) access at a
level, either ReadOnly or ReadWrite.

Two or more servers may have different defaults by specifying a different
name for the $OTTER_GLOBAL_ACCESS_USER in OtterDefs.pm.  

 e.g. Internal Server - default read write
        $OTTER_GLOBAL_ACCESS_USER = 'GLOBAL_READWRITE'
        has a rule (id, '%', 'Global read write', 'RW')

      External Server - default read only
        $OTTER_GLOBAL_ACCESS_USER = 'GLOBAL_READONLY'
        has a rule (id, '%', 'Global read only', 'RO')
        or more limiting, has a rule (id, 'encode', 'encode read only', 'RO')


=head1 STEP BY STEP

1. Check out conf/README.user.pod and set up if required.

2. Set the name for the $OTTER_GLOBAL_ACCESS_USER in OtterDefs.pm

3. Set up the default user using scripts/user_access -default
   Note this script is client side OtterDefs.pm, the server side variable
   will also need to be set.

4. Create users using the scripts/user_access script.
   You will be prompted to set either default rule for them or specify
   a new one.

5. Check out it all works


N.B. scripts/user_access -assignAllDefault will give all the users in the 
database the default rule.


=head1 SQL

DROP TABLE IF EXISTS access_author;
CREATE TABLE access_author (
  access_id int(10) unsigned NOT NULL,
  author_id int(10) unsigned NOT NULL,
  PRIMARY KEY (access_id, author_id)
) TYPE=InnoDB;

DROP TABLE IF EXISTS sequence_set_access;
CREATE TABLE sequence_set_access (
  access_id int(10) unsigned NOT NULL auto_increment,
  access_spec varchar(20) NOT NULL,
  description varchar(100) default '',
  access_level enum('RO', 'RW') default 'RO' NOT NULL,
  PRIMARY KEY (access_id)
) TYPE=InnoDB;


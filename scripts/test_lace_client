#!/usr/local/bin/perl5.6.1 -w

### test_lace_client

use strict;
use Bio::Otter::Lace::AceDatabase;
use Bio::Otter::Lace::Client;
use Data::Dumper;   # For debugging

{
    my $cl = Bio::Otter::Lace::Client->new;
    $cl->host('ecs1d');
    $cl->port(39312);
    
    my ($ds) = grep $_->name eq 'human_chr20_with_anal_end_feb',
        $cl->get_all_DataSets;
    
    #foreach my $chr ($ds->get_all_Chromosomes) {
    #    print "chr: ", Dumper($chr);
    #}
    
    my $cs_list = $ds->get_all_CloneSequences;
    #print Dumper($cs_list);
    
    $ds->selected_CloneSequences([@$cs_list[50..55]]);
    
    my $db = Bio::Otter::Lace::AceDatabase->new;
    $db->title('lace test');
    $db->make_database_directory;
    
    my $dir = $db->home;
    my $otter_ace = "$dir/rawdata/otter.ace";
    open OTT_ACE, "> $otter_ace" or die "Can't write to '$otter_ace'";
    print OTT_ACE $cl->get_otter_ace;
    close OTT_ACE;
    $db->add_acefile($otter_ace);
    unless ($db->initialize_database) {
        $db->error_flag(1);
        die "Error initialzing database";
    }
    
    $cl->save_all_slices($db);
}


__END__

=head1 NAME - test_lace_client

=head1 AUTHOR

James Gilbert B<email> jgrg@sanger.ac.uk

